<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<title></title>
	</head>

	<body>
		<!--具体示例见test文件下的1.html和2.html-->
		<iframe src="http://127.0.0.1:8020/javascript/GHTML5%e8%84%9a%e6%9c%ac%e7%bc%96%e7%a8%8b/test.html" width="400px" height="" id="myframe"></iframe>
		
	</body>
	<script>
		//什么是跨文档消息传递
		//跨文档消息传送（cross-document messaging），有时候简称为 XDM，指的是在来自不同域的页面间递消息。例如，www.wrox.com 域中的页面与位于一个内嵌框架中的 p2p.wrox.com 域中的页面通信
		//console.log(document.querySelector("iframe"))

		//XDM 的核心是 postMessage()方法:
		//对于 XDM 而言，“另一个地方”指的是包含在当前页面中的<iframe>元素，或者由当前页面弹出的窗口。
		/*
		 * postMessage()方法接收两个参数：一条消息和一个表示消息接收方来自哪个域的字符串。第二
个参数对保障安全通信非常重要，可以防止浏览器把消息发送到不安全的地方。来看下面的例子。
		 */

		var iframeWindow = document.getElementById("myframe").contentWindow;

		iframeWindow.postMessage("A secret", "http://127.0.0.1:8020/javascript/GHTML5%e8%84%9a%e6%9c%ac%e7%bc%96%e7%a8%8b/test.html");

		/*
	 * 最后一行代码尝试向内嵌框架中发送一条消息，并指定框架中的文档必须来源于"http:// 
www.wrox.com"域。如果来源匹配，消息会传递到内嵌框架中；否则，postMessage()什么也不做。
这一限制可以避免窗口中的位置在你不知情的情况下发生改变。如果传给 postMessage()的第二个参
数是"*"，则表示可以把消息发送给来自任何域的文档，但我们不推荐这样做
	 */
		/*
	 * 接收到 XDM 消息时，会触发 window 对象的 message 事件。这个事件是以异步形式触发的，因此
从发送消息到接收消息（触发接收窗口的 message 事件）可能要经过一段时间的延迟。
	 */
		/*
		 * 传递给 onmessage 处理程序的事件对象包含以下三方面的重要信息。
		 */
		/*
	 * data：作为 postMessage()第一个参数传入的字符串数据。
 origin：发送消息的文档所在的域，例如"http://www.wrox.com"。
 source：发送消息的文档的 window 对象的代理。这个代理对象主要用于在发送上一条消息的
窗口中调用 postMessage()方法。如果发送消息的窗口来自同一个域，那这个对象就是
window
	 */
		
	</script>

</html>